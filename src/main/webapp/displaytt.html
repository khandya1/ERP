<!DOCTYPE html>
<html lang="en">
<style>
    table{

        border-collapse: collapse;
        font-size: 0.9em;
        font-family: sans-serif;
        min-width: 400px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
        margin-left:auto;
        margin-right:auto;

    }
    td,tr {

        background-color: #513d66   ;
        color: #ffffff;
        text-align: left;
    }
    body{
        background-color: #ead6ff;
        font-family: 'Roboto', sans-serif;
    }
    thead{
        background-color: #0DB8DE;   ;
        color: #ffffff;
        text-align: left;

    }




</style>

<title>TimeTable</title>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.68/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.68/vfs_fonts.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IIITB</title>
    <link rel="stylesheet" href="assets/css/style1.css" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">


</head>
<body style="background-color: #ead6ff">


<div id="page">
    <div id="home-header">
        <div><a href="index.html" class="logo"><img src="assets/images/iiitb_logo.png" alt="" style="border: 1px solid #ddd;border-radius: 4px; padding: 5px;width: 80px;"></a>
            <div class="navbar-collapse" id="bs-example-navbar-collapse-1" >
                <ul class="nav navbar-nav navbar-right" >
                    <li><a data-scroll href="index.html" >HOME <span class="sr-only"(current)></span></a></li>
                    <li><a data-scroll href="NewStudent.html" >Student Registration <span class="sr-only"(current)></span></a></li>
                    <li><a data-scroll href="NewCourse.html" >Course Registration<span class="sr-only"(current)></span></a></li>
                    <li><a data-scroll href="displaytt.html" >Course Schedule<span class="sr-only"(current)></span></a></li>
                    <li ><a href="login.html" class="btn btn-info" role="button">Login</a></li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </div>
    </div>
</div><!-- /.page -->


<h2 style="align-content: center">TimeTable</h2>

<br>
<div id ="domainbox" class="table-responsive-lg" style="display: block"></div>

<button onclick="getvalueofradiolist1()" type="submit"  id="domain_button" style="display: none" class="btn-pill">Course</button>

<div id= "box" class="table-responsive-lg" style="display: block"></div>
<button onclick="getvalueofradiolist()" type="submit" id="course_button" style="display: none" class="btn-pill">Course Schedule</button>
<button onclick="getvalueofradiolist2()" type="submit" id="student_button" style="display: none" class="btn-pill">Student List</button>
<div id= "box1" class="table-responsive-lg" style="display: block"></div>
<div id  = "stu" class="table-responsive-lg" style="display: block"></div>



<script>
    let x;

    async function function1 () {

        let response = await fetch('http://localhost:8080/ERP_war_exploded/api/domain/display', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json;charset=utf-8'
            },
        });

        try {
            let result = await response.json();
            x = result[0].domain_id;
            console.log(x);
            let html = "<table id ='t1' class='table table-striped' style='width: max-content'  size='100%'>";
            //let x=JSON.stringify(result);
            //console.log(x);
            html += "<thead style='background-color: #0DB8DE;  '>"
            html += "<tr>";
            html += "<th style='background-color: #0DB8DE;  '> Select </th>";
            html += "<th style='background-color: #0DB8DE;  '>Program</th>";
            html += "<th style='background-color: #0DB8DE;  '>Batch</th>";
            html += "</tr>";
            html += "</thead>"
            for (let i = 0; i < result.length; i++) {
                console.log(result[i].name);
                html += "<tr>";
                x = result[i].domain_id;
                console.log(x);
                html += "<td><input type=radio id ='choiceLabel' name =domain value =" + x + "></td>";
                html += "<td>" + result[i].program + "</td>";
                html += "<td>" + result[i].batch + "</td>";

                html += "</tr>";

            }
            html += "</table>";

            document.getElementById("domainbox").innerHTML = html;
            document.getElementById("domain_button").style.display = "block";
            document.getElementById("course_button").style.display = "none";
            document.getElementById("student_button").style.display = "none";
        }
        catch(err) { }

    }

    async function getvalueofradiolist1() {

        let radioButtonlist = document.getElementsByName("domain");
        for (let x = 0; x < radioButtonlist.length; x++) {
            if (radioButtonlist[x].checked) {
                alert("Selected item Value "  + radioButtonlist[x].value);
                document.getElementById("domainbox").style.display="none";
                let p =radioButtonlist[x].value;
                function2(radioButtonlist[x].value);
            }
        }

    }


    async function function2 (p) {

        console.log(p);
        let response = await fetch('http://localhost:8080/ERP_war_exploded/api/courses/checkDomain', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json;charset=utf-8'
            },
            body: JSON.stringify({
                domain_id: p }),
        });
        document.getElementById("domainbox").style.display = "block";

        try {
            let result = await response.json();
            let html = "<table  id ='t2' class='table table-striped' style='width: max-content'  size='100%'>";
            //let x=JSON.stringify(result);
            //console.log(x);
            html += "<thead style='background-color: #0DB8DE;  '>"
            html += "<tr>";
            html += "<th style='background-color: #0DB8DE;  '>Select</th>";
            html += "<th style='background-color: #0DB8DE;  '>Course Code</th>";
            html += "<th style='background-color: #0DB8DE;  '>Name</th>";
            html += "<th style='background-color: #0DB8DE;  '>Description</th>";
            html += "<th style='background-color: #0DB8DE;  '>Term</th>";
            html += "<th style='background-color: #0DB8DE;  '>Year</th>";
            html += "<th style='background-color: #0DB8DE;  '>Capacity</th>";
            html += "<th style='background-color: #0DB8DE;  '>Credits</th>";
            html += "<th style='background-color: #0DB8DE;  '>Faculty</th>";
            html += "</tr>";
            html += "</thead>"
            for (let i = 0; i < result.length; i++) {
                console.log(result[i].name);
                html += "<tr>";
                x = result[i].course_id;
                console.log(x);
                html += "<td><input type=radio id ='choiceLabel' name =course value =" + x + "></td>";
                html += "<td>" + result[i].course_code + "</td>";
                html += "<td>" + result[i].name + "</td>";
                html += "<td>" + result[i].description + "</td>";
                html += "<td>" + result[i].term + "</td>";
                html += "<td>" + result[i].year + "</td>";
                html += "<td>" + result[i].capacity + "</td>";
                html += "<td>" + result[i].credits + "</td>";
                html += "<td>" + result[i].faculty + "</td>";
                html += "</tr>";

            }
            html += "</table>";

            document.getElementById("box").innerHTML = html;

            document.getElementById("domain_button").style.display = "none";
            document.getElementById("course_button").style.display = "inline";
            document.getElementById("student_button").style.display = "inline";

        }
        catch
            (err)
        {

        }

    }

    async function getvalueofradiolist() {

        let radioButtonlist = document.getElementsByName("course");
        for (let x = 0; x < radioButtonlist.length; x++) {
            if (radioButtonlist[x].checked) {
                alert("Selected item Value "  + radioButtonlist[x].value);
                document.getElementById("box").style.display="none";
                let p =radioButtonlist[x].value;
                function3(radioButtonlist[x].value);
            }
        }

    }

    async function function3(p) {


        console.log(p);

        let r_courseSch = await fetch('http://localhost:8080/ERP_war_exploded/api/courseschedule/checkCourse', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json;charset=utf-8'
            },
            body: JSON.stringify({
                course_id: p }),
        });
        document.getElementById("domainbox").style.display = "block";
        document.getElementById("box").style.display = "block";

        try {
            let result_cs = await r_courseSch.json();
            let html1 = "<table  class='table table-striped' style='width: max-content'  size='100%'>";
            //let x=JSON.stringify(result);
            //console.log(x);

            html1 += "<thead style='background-color: #0DB8DE;  '>"
            html1 += "<tr>";
           html1 += "<th style='background-color: #0DB8DE;  '>Course Code</th>";
            html1 += "<th style='background-color: #0DB8DE;  '>Course Name</th>";
            html1 += "<th style='background-color: #0DB8DE;  '>Building</th>";
            html1 += "<th style='background-color: #0DB8DE;  '>Room</th>";
            html1 += "<th style='background-color: #0DB8DE;  '>Time</th>";
            html1 += "<th style='background-color: #0DB8DE;  '>Day</th>";
            html1 += "</tr>";
            html1 += "</thead>"
            for (let i = 0; i < result_cs.length; i++) {
                console.log(result_cs[i].building);
                html1 += "<tr>";
                html1 += "<td>" + result_cs[i].id + "</td>";
                html1 += "<td>" + result_cs[i].course.course_code + "</td>";
                html1 += "<td>" + result_cs[i].course.name + "</td>";
                html1 += "<td>" + result_cs[i].building + "</td>";
                html1 += "<td>" + result_cs[i].room + "</td>";
                html1 += "<td>" + result_cs[i].time + "</td>";
                html1 += "<td>" + result_cs[i].day + "</td>";


                //    html1 += "<td>" + result_cs[i].course.domain.domain_id + "</td>";

                html1 += "</tr>";

            }
            html1 += "</table>";

            document.getElementById("box1").innerHTML = html1;

            document.getElementById("domain_button").style.display = "none";
            document.getElementById("course_button").style.display = "none";
            document.getElementById("student_button").style.display = "none";



            let docDef = {
                content: [
                    {
                        layout: 'lightHorizontalLines', // optional
                        table: {
                            // headers are automatically repeated if the table spans over multiple pages
                            // you can declare how many rows should be treated as headers
                            headerRows: 1,
                            widths: [ '*', 'auto', 100, '*','auto' ],

                            body: [
                                [ "Course_Code ", 'Course_Name', 'Day', 'Time','Building' ],
                                [ result_cs[0].course.course_code,result_cs[0].course.name, result_cs[0].day, result_cs[0].time, result_cs[0].building ],
                                [ result_cs[1].course.course_code,result_cs[1].course.name, result_cs[1].day, result_cs[1].time, result_cs[1].building ]
                            ]
                        }
                    }
                ]

            }
            pdfMake.createPdf(docDef).download();



        } catch (err) {

        }

    }


    async function getvalueofradiolist2() {

        let radioButtonlist = document.getElementsByName("course");
        for (let x = 0; x < radioButtonlist.length; x++) {
            if (radioButtonlist[x].checked) {
                alert("Selected item Value "  + radioButtonlist[x].value);
                document.getElementById("box").style.display="none";
                var p =radioButtonlist[x].value;
                function4(radioButtonlist[x].value);
            }
        }

    }


    async function function4(p) {
        let studentfetch = await fetch('http://localhost:8080/ERP_war_exploded/api/Student/getstudentlist', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json;charset=utf-8'
            },
            body: JSON.stringify({
                course_id: p
            }),
        });
        document.getElementById("domainbox").style.display = "block";
        document.getElementById("box").style.display = "block";
        try {
            let result_cs = await studentfetch.json();
            let html1 = "<table border='1|1' class='table table-striped' style='width: max-content'  size='100%'>";
            //let x=JSON.stringify(result);
            //console.log(x);
            html1 += "<thead>"
            html1 += "<tr>";
            html1 += "<th>Roll No</th>";
            html1 += "<th>First Name</th>";
            html1 += "<th>Last Name</th>";
            html1 += "<th>Email</th>";
            html1 += "<th>CGPA</th>";
            html1 += "<th>Total Credit</th>";
            html1 += "<th>Graduation year</th>";
            html1 += "</tr>";
            html1 += "</thead>"
            for (let i = 0; i < result_cs.length; i++) {
                console.log(result_cs[i].first_name);
                html1 += "<tr>";
                html1 += "<td>" + result_cs[i].roll_no + "</td>";
                html1 += "<td>" + result_cs[i].first_name + "</td>";
                html1 += "<td>" + result_cs[i].last_name + "</td>";
                html1 += "<td>" + result_cs[i].email + "</td>";
                html1 += "<td>" + result_cs[i].cgpa + "</td>";
                html1 += "<td>" + result_cs[i].total_credit + "</td>";
                html1 += "<td>" + result_cs[i].grad_year + "</td>";
                html1 += "</tr>";
            }
            document.getElementById("stu").innerHTML = html1;

            document.getElementById("domain_button").style.display = "none";
            document.getElementById("course_button").style.display = "none";
            document.getElementById("student_button").style.display = "none";

        }
        catch (err){}
    }




    function start() {
        function1();
    }
    window.onload = start;



    //
    // let docDef = {
    //     content: [
    //         {
    //             layout: 'lightHorizontalLines', // optional
    //             table: {
    //                 // headers are automatically repeated if the table spans over multiple pages
    //                 // you can declare how many rows should be treated as headers
    //                 headerRows: 1,
    //                 widths: [ '*', 'auto', 100, '*' ],
    //
    //                 body: [
    //                     [ "Monday ", 'Tuesday', 'Wednesday', 'Thursday' ],
    //                     [ 'Value 1', 'Value 2', 'Value 3', 'Value 4' ],
    //                     [ { text: 'Bold value', bold: true }, 'Val 2', 'Val 3', 'Val 4' ]
    //                 ]
    //             }
    //         }
    //     ]
    //
    // }
    // pdfMake.createPdf(docDef).download();

</script>


</body>
</html>
